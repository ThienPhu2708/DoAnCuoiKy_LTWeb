@model IEnumerable<DoAn_LTWeb.Models.SANPHAM>



@if (Model != null && Model.Any())
{
    <div class="list-group">
        @foreach (var item in Model)
        {
            // Lấy giá của biến thể đầu tiên (để hiển thị giá "từ...")
            var firstVariant = item.SANPHAM_BIENTHE.OrderBy(v => v.GIABAN).FirstOrDefault();
            decimal price = firstVariant != null ? (firstVariant.GIABAN ?? 0) : 0;
            decimal? oldPrice = firstVariant != null ? firstVariant.GIAGOC : null;

            <a href="@Url.Action("Details", "Store", new { id = item.MASP })" class="list-group-item list-group-item-action d-flex align-items-center">

                <img src="@Url.Content("~/Content/Assets/Product_Images/" + item.ANHBIA)"
                     style="width: 50px; height: 50px; object-fit: cover;"
                     class="me-3 rounded border">

                <div>
                    <div class="fw-bold text-dark">@item.TENSP</div>
                    <div class="small">
                        <span class="text-danger fw-bold">@string.Format("{0:N0} đ", price)</span>

                        @if (oldPrice.HasValue && oldPrice > price)
                        {
                            <span class="text-muted text-decoration-line-through ms-2">
                                @string.Format("{0:N0} đ", oldPrice)
                            </span>
                        }
                    </div>
                </div>
            </a>
        }

        <a href="#" class="list-group-item list-group-item-action text-center text-primary small fw-bold bg-light"
           onclick="$(this).closest('form').submit(); return false;">
            Xem tất cả kết quả
        </a>
    </div>
}
else
{
    <div class="list-group">
        <div class="list-group-item text-muted small text-center py-3">
            <i class="fas fa-search me-2"></i> Không tìm thấy sản phẩm nào.
        </div>
    </div>
}
